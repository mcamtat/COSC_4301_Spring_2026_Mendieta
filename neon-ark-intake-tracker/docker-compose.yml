version: "3.8"                     # Docker Compose file format version.
  # This tells Docker how to interpret the file structure.
# Version 3.8 is stable and commonly used with Docker Desktop.

services:                          # Top-level section that defines all containers (services)
  # that make up this environment.

  postgres-db:                     # Logical service name used internally by Docker Compose.
    # Other services (like Spring Boot) can reference this name.

    container_name: neon_ark_db    # Explicit container name.
      # Prevents Docker from auto-generating random names.
    # Makes it easy to identify in Docker Desktop and logs.

    image: postgres:16             # Specifies the Docker image to use.
      # This pulls PostgreSQL version 16 from Docker Hub.
    # Locks the database engine version for consistency.

    restart: always                # Automatically restarts the container if it stops.
      # Ensures the database comes back up after crashes
    # or system reboots without manual intervention.

    environment:                   # Environment variables passed into the container.
      # PostgreSQL reads these on startup to configure itself.

      POSTGRES_USER: neonark       # Database username created automatically at startup.
      # This is the account Spring Boot will connect with.

      POSTGRES_PASSWORD: neonarkpass
        # Password for the database user.
      # Required for secure authentication.

      POSTGRES_DB: intake_tracker
        # Name of the database created automatically.
      # This is where habitats and creatures tables will live.

      POSTGRES_HOST_AUTH_METHOD: password
        # Forces PostgreSQL to require password-based authentication.
        # Prevents insecure trust-based access.
      # Mirrors real production security expectations.

    ports:                         # Defines port mappings between host and container.

      - "5437:5432"                # Maps host port 5437 â†’ container port 5432.
        # 5432 is PostgreSQL's default internal port.
      # 5437 avoids conflicts with local installations.

    volumes:                       # Defines persistent storage mappings.

      - neonark_pgdata:/var/lib/postgresql/data
        # Maps a named Docker volume to PostgreSQL's data directory.
        # Ensures database data persists across container restarts
      # and Docker shutdowns.

volumes:                           # Top-level volume definitions.

  neonark_pgdata:                  # Name of the persistent volume.
    # Used above in the service definition.

    driver: local                  # Uses Docker's local storage driver.
    # Stores data safely on the host machine.